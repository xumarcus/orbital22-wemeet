= WeMeet 0.3.0 API Reference
Marcus Xu;
:toc:

Almost all the API is generated by Spring Data Rest. All the requests and responses below are generated from integration tests by Spring Rest Docs. In addition, we expose a GUI at `/api/explorer` to discover API features.

[[supported_http_methods]]
.Supported HTTP Methods
* `POST /api/:resource` for creation
* `GET /api/:resource/:id` for read
* `PUT /api/:resource/:id` for update (replace with new data)
* `PATCH /api/:resource/:id` for update (modify specified fields)
* `DELETE /api/:resource/:id` for deletion
** `204 No content` if successful

== User API
Users can be initially unregistered (created through invitations). The API is identical regardless of this.

=== Creation

Send `rawPassword` with at least 8 characters.

include::{snippets}/post-users-registered-success/http-request.adoc[]

If successful, return `201 Created` with `Location` set to `/api/users/:id`.

include::{snippets}/post-users-registered-success/http-response.adoc[]

==== Counterexamples

include::{snippets}/post-users-registered-password-error/http-request.adoc[]
include::{snippets}/post-users-registered-password-error/http-response.adoc[]

The `email` field is validated.

include::{snippets}/post-users-registered-email-error/http-request.adoc[]
include::{snippets}/post-users-registered-email-error/http-response.adoc[]

=== Read

include::{snippets}/get-users-success/http-request.adoc[]
include::{snippets}/get-users-success/http-response.adoc[]

In addition, `/api/users/me` provides current session user ID if that is not known.
include::{snippets}/get-users-me-success/http-request.adoc[]

Response is forwarded to `/api/users/:id`.

=== Update
See <<supported_http_methods>>

=== Delete
See <<supported_http_methods>>

== Roster Plan API
The current API stores meeting metadata in the entity `rosterPlan`. Generated solutions are stored in a new instance of `rosterPlan` To be refactored in later versions.

=== Creation
`title` cannot be blank.

include::{snippets}/givenValidRequest_whenCreate_thenCreateEmptyRosterPlan/http-request.adoc[]

If successful, return `201 Created` with `Location` set to `/api/rosterPlan/:id`.

include::{snippets}/givenValidRequest_whenCreate_thenCreateEmptyRosterPlan/http-response.adoc[]

=== Create solution
This API will be deprecated.

include::{snippets}/post-solution-success/http-request.adoc[]
include::{snippets}/post-solution-success/http-response.adoc[]

=== Read solution
This API will be deprecated.

Before solver completes,
include::{snippets}/get-solution-before-solver-runs-success/http-request.adoc[]
include::{snippets}/get-solution-before-solver-runs-success/http-response.adoc[]

After solver completes,
include::{snippets}/get-solution-after-solver-runs-success/http-request.adoc[]
include::{snippets}/get-solution-after-solver-runs-success/http-response.adoc[]

=== Publish solution
This API will be deprecated.

include::{snippets}/post-solution-publish-success/http-request.adoc[]
include::{snippets}/post-solution-publish-success/http-response.adoc[]

==== Counterexamples

If `title` is blank,
include::{snippets}/givenInvalidRequest_whenCreate_thenBadRequest/http-request.adoc[]

Then
include::{snippets}/givenInvalidRequest_whenCreate_thenBadRequest/http-response.adoc[]

If user is not logged in,
include::{snippets}/givenAnonymousUser_whenCreate_thenRedirectToLogin/http-request.adoc[]

Then
include::{snippets}/givenAnonymousUser_whenCreate_thenRedirectToLogin/http-response.adoc[]

=== Read
include::{snippets}/get-rosterPlan-success/http-request.adoc[]
include::{snippets}/get-rosterPlan-success/http-response.adoc[]

=== Update
The current API disables ACL checks. In later versions user will need to be invited to view meeting information. See <<supported_http_methods>> for updating attributes. Refer to API below to update sub-resources.

=== Delete
See <<supported_http_methods>>. Recursively deletes sub-resources.

== Time Slot API
Sub-resource of Roster Plan

=== Creation

.Validation
* `startDateTime`: ISOString format, earlier than `endDateTime`
* `endDateTime`: ISOString format, later than `startDateTime`
* `capacity`: positive integer
* `rosterPlan`: URI aka `/api/rosterPlan/:id`, the Roster Plan this time slot refers to

include::{snippets}/post-timeSlot-success/http-request.adoc[]

If successful, return `201 Created` with `Location` set to `/api/timeSlot/:id`.
include::{snippets}/post-timeSlot-success/http-response.adoc[]

==== Counterexamples

Date time issues
include::{snippets}/post-timeSlot-date-time-error/http-request.adoc[]
include::{snippets}/post-timeSlot-date-time-error/http-response.adoc[]

=== Read
See <<supported_http_methods>>

=== Update
See <<supported_http_methods>>

=== Delete
See <<supported_http_methods>>

== Roster Plan User Info API
Sub-resource of Roster Plan

=== Creation
.Validation
* `locked`: boolean.
** This feature is under refinement.
** If the user is locked, solver will lock in allocations of the user
* `email`: Email of the user to be invited
* `rosterPlan`: URI aka `/api/rosterPlan/:id`, the `rosterPlan` this time slot refers to

include::{snippets}/post-rosterPlanUserInfo-success/http-request.adoc[]

If successful, return `201 Created` with `Location` set to `/api/rosterPlanUserInfo/:id`.
include::{snippets}/post-rosterPlanUserInfo-success/http-response.adoc[]

=== Read
See <<supported_http_methods>>

=== Update
See <<supported_http_methods>>

=== Delete
See <<supported_http_methods>>

== Time Slot User Info API
Sub-resource of Time Slot

=== Creation
.Validation
* `rank`: positive integer.
* `timeSlot`: URI aka `/api/timeSlot/:id`, the `timeSlot` this association resource refers to

include::{snippets}/post-timeSlotUserInfo-success/http-request.adoc[]

If successful, return `201 Created` with `Location` set to `/api/timeSlotUserInfo/:id`.
include::{snippets}/post-timeSlotUserInfo-success/http-response.adoc[]

=== Read
See <<supported_http_methods>>

=== Update
See <<supported_http_methods>>

=== Delete
See <<supported_http_methods>>